<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Corrects a series of abnormal diameters of the tree using the
mean growth of other trees (with a minimum number of trees) of the same
species/genus/family/stand of the same diameter class."><title>Phylogenetic Hierarchical Correction — PhylogeneticHierarchicalCorrection • TreeData</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetic Hierarchical Correction — PhylogeneticHierarchicalCorrection"><meta property="og:description" content="Corrects a series of abnormal diameters of the tree using the
mean growth of other trees (with a minimum number of trees) of the same
species/genus/family/stand of the same diameter class."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TreeData</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/TreeData.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/VincyaneBadouard/TreeData/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Phylogenetic Hierarchical Correction</h1>
      <small class="dont-index">Source: <a href="https://github.com/VincyaneBadouard/TreeData/blob/HEAD/R/PhylogeneticHierarchicalCorrection.R" class="external-link"><code>R/PhylogeneticHierarchicalCorrection.R</code></a></small>
      <div class="d-none name"><code>PhylogeneticHierarchicalCorrection.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Corrects a series of abnormal diameters of the tree using the
mean growth of other trees (with a minimum number of trees) of the same
species/genus/family/stand of the same diameter class.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PhylogeneticHierarchicalCorrection</span><span class="op">(</span></span>
<span>  <span class="va">DataTree</span>,</span>
<span>  <span class="va">Data</span>,</span>
<span>  <span class="va">cresc</span>,</span>
<span>  <span class="va">cresc_abs</span>,</span>
<span>  <span class="va">cresc_abn</span>,</span>
<span>  <span class="va">DBHCor</span>,</span>
<span>  <span class="va">Time</span>,</span>
<span>  <span class="va">PositiveGrowthThreshold</span>,</span>
<span>  <span class="va">NegativeGrowthThreshold</span>,</span>
<span>  DBHRange <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  MinIndividualNbr <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  OtherCrit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">coef</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>DataTree</dt>
<dd><p>A dataset corresponding to a single tree/stem's (1
IdTree/IdStem) measurements (data.table)
The dataset must contain the columns:</p><ul><li><p><code>IdStem</code> or <code>IdTree</code>(character)</p></li>
<li><p><code>ScientificName_TreeDataCor</code> (character)</p></li>
<li><p><code>Genus_TreeDataCor</code> (character)</p></li>
<li><p><code>Family_TreeDataCor</code> (character)</p></li>
<li><p><code>Diameter</code> (numeric)</p></li>
<li><p><code>Year</code> (numeric)</p></li>
</ul></dd>


<dt>Data</dt>
<dd><p>Complete dataset (data.table)
The dataset must contain the columns:</p><ul><li><p><code>IdStem</code> (character)</p></li>
<li><p><code>ScientificName_TreeDataCor</code> (character)</p></li>
<li><p><code>Genus_TreeDataCor</code> (character)</p></li>
<li><p><code>Family_TreeDataCor</code> (character)</p></li>
<li><p><code>Diameter</code> (numeric)</p></li>
<li><p><code>Year</code> (numeric)</p></li>
</ul></dd>


<dt>cresc</dt>
<dd><p>Annual diameter increment (numeric)</p></dd>


<dt>cresc_abs</dt>
<dd><p>Absolute diameter increment (not divided by time between 2
values) (numeric)</p></dd>


<dt>cresc_abn</dt>
<dd><p>Abnormal diameter increment positions (numeric)</p></dd>


<dt>DBHCor</dt>
<dd><p>Diameter vector in cm (numeric)</p></dd>


<dt>Time</dt>
<dd><p>Time vector in years (numeric)</p></dd>


<dt>PositiveGrowthThreshold</dt>
<dd><p>in cm/year : a tree
widening by more than x cm/year is considered abnormal (numeric, 1 value)</p></dd>


<dt>NegativeGrowthThreshold</dt>
<dd><p>in cm/census : The possible
positive measurement error (+n) cannot be corrected until the growth
appears abnormal, but a negative measurement error can be allowed until -n
(a tree does not decrease). Thus the positive measurement error (+n) is
"compensated". (numeric, 1 value)</p></dd>


<dt>DBHRange</dt>
<dd><p>DBH range in cm to take into account to select other trees in
the dataset to apply "phylogenetic hierarchical" correction (Default: 10
cm) (numeric, 1 value)</p></dd>


<dt>MinIndividualNbr</dt>
<dd><p>Minimum number of individuals to take into account in
"phylogenetic hierarchical" correction (Default: 5) (numeric, 1 value)</p></dd>


<dt>OtherCrit</dt>
<dd><p>Other criteria to select the individuals used for the
calculation of the mean growth. Give the name of the column(s) for which the
individuals must have the same value as the tree to correct (e.g. c("Plot",
"Subplot")) (character)</p></dd>


<dt>coef</dt>
<dd><p>(numeric) Necessary argument in case the number of individuals is
insufficient to apply the "phylogenetic hierarchical" correction, and in
this case the "individual" correction is applied (see
IndividualDiameterShiftCorrection() function)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Fill columns:</p><ul><li><p><em>DBHCor</em>: corrected trees diameter at default HOM</p></li>
<li><p><em>DiameterCorrectionMeth</em> = "species"/"genus"/"family"/"stand"/"shift
realignment"</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It is assumed that these abnormal diameters were measured at a
different height than the default. We therefore correct the 1st value
with the mean growth of other trees. The following values are
corrected from the corrected value of the 1st value, keeping the
originally measured growth.</p><ul><li><p>Correct the 1st value in the series:</p><ul><li><p>Find other individual of the same diameter class (<em>DBHRange</em>) as the last
value before the one to correct, and of the same species, genus, family or
stand than the tree to correct, until the minimum number of individuals
required to consider the correction is reached (<em>MinIndividualNbr</em>). Take
only their non-abnormal growths that have not been measured to a different
HOM than their previous value.</p></li>
<li><p>1st abnormal DBH in the series = previous value + mean growth of the
other trees</p></li>
</ul></li>
<li><p>Correct the following values in the series: The other abnormal DBH in the
series = previous value + their original growth.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">TestData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DataTree</span> <span class="op">&lt;-</span> <span class="va">TestData</span><span class="op">[</span><span class="va">IdTree</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"100658"</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inputs</span></span></span>
<span class="r-in"><span><span class="va">DataTree</span><span class="op">$</span><span class="va">Year</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2002</span>, <span class="fl">2004</span>, <span class="fl">2006</span>, <span class="fl">2008</span>, <span class="fl">2010</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DataTree</span><span class="op">$</span><span class="va">Diameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cresc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="cn">NA</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cresc_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cresc_abn</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DataTree_output</span> <span class="op">&lt;-</span> <span class="fu">PhylogeneticHierarchicalCorrection</span><span class="op">(</span></span></span>
<span class="r-in"><span>    DataTree <span class="op">=</span> <span class="va">DataTree</span>,</span></span>
<span class="r-in"><span>    Data <span class="op">=</span> <span class="va">TestData</span>,</span></span>
<span class="r-in"><span>    cresc <span class="op">=</span> <span class="va">cresc</span>, cresc_abs <span class="op">=</span> <span class="va">cresc_abs</span>, cresc_abn <span class="op">=</span> <span class="va">cresc_abn</span>,</span></span>
<span class="r-in"><span>    DBHCor <span class="op">=</span> <span class="va">DataTree</span><span class="op">$</span><span class="va">Diameter</span>, Time <span class="op">=</span> <span class="va">DataTree</span><span class="op">$</span><span class="va">Year</span>,</span></span>
<span class="r-in"><span>    PositiveGrowthThreshold <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    NegativeGrowthThreshold <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>    DBHRange <span class="op">=</span> <span class="fl">10</span>, MinIndividualNbr <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    OtherCrit <span class="op">=</span> <span class="st">"Plot"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Vincyane Badouard, Valentine Herrmann, Nino Page, Camille Piponiot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

